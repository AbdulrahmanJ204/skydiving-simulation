{
    "sourceFile": "src/script.js",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 5,
            "patches": [
                {
                    "date": 1753964801196,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                },
                {
                    "date": 1753964820030,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -25,14 +25,14 @@\n // Scene\r\n const scene = new THREE.Scene();\r\n const loaderCube = new THREE.CubeTextureLoader();\r\n const skyboxTexture = loaderCube.load([\r\n-  \"./static/skybox/posx.jpg\",\r\n-  \"./static/skybox/negx.jpg\",\r\n-  \"./static/skybox/posy.jpg\",\r\n-  \"./static/skybox/negy.jpg\",\r\n-  \"./static/skybox/posz.jpg\",\r\n-  \"./static/skybox/negz.jpg\",\r\n+  \"./skybox/posx.jpg\",\r\n+  \"./skybox/negx.jpg\",\r\n+  \"./skybox/posy.jpg\",\r\n+  \"./skybox/negy.jpg\",\r\n+  \"./skybox/posz.jpg\",\r\n+  \"./skybox/negz.jpg\",\r\n ]);\r\n scene.background = skyboxTexture;\r\n  \r\n // Model\r\n"
                },
                {
                    "date": 1753964909008,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -47,9 +47,9 @@\n });\r\n \r\n gltfLoader.load(\"./models/parachute.glb\", (gltf) => {\r\n   parachuteModel = gltf.scene;\r\n-  parachuteModel.scale.set(3, 3, 3);\r\n+  parachuteModel.scale.set(0.8, 0.8, 0.8);\r\n   parachuteModel.visible = false;\r\n   scene.add(parachuteModel);\r\n   skyDiver.setParachute(parachuteModel);\r\n });\r\n"
                },
                {
                    "date": 1753964939948,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -47,9 +47,9 @@\n });\r\n \r\n gltfLoader.load(\"./models/parachute.glb\", (gltf) => {\r\n   parachuteModel = gltf.scene;\r\n-  parachuteModel.scale.set(0.8, 0.8, 0.8);\r\n+  parachuteModel.scale.set(0.8, 0.8, 0.5);\r\n   parachuteModel.visible = false;\r\n   scene.add(parachuteModel);\r\n   skyDiver.setParachute(parachuteModel);\r\n });\r\n"
                },
                {
                    "date": 1753965120686,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -49,8 +49,13 @@\n gltfLoader.load(\"./models/parachute.glb\", (gltf) => {\r\n   parachuteModel = gltf.scene;\r\n   parachuteModel.scale.set(0.5, 0.5, 0.5);\r\n   parachuteModel.visible = false;\r\n+  parachuteModel.traverse((child) => {\r\n+    if (child.isMesh && child.name.toLowerCase().includes(\"ground\")) {\r\n+      child.visible = false;\r\n+    }\r\n+  });\r\n   scene.add(parachuteModel);\r\n   skyDiver.setParachute(parachuteModel);\r\n });\r\n // Sizes\r\n"
                },
                {
                    "date": 1753965143851,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -45,16 +45,16 @@\n   scene.add(skydiverModel);\r\n   skyDiver.setModel(skydiverModel);\r\n });\r\n \r\n-gltfLoader.load(\"./models/parachute.glb\", (gltf) => {\r\n-  parachuteModel = gltf.scene;\r\n-  parachuteModel.scale.set(0.5, 0.5, 0.5);\r\n-  parachuteModel.visible = false;\r\n+// gltfLoader.load(\"./models/parachute.glb\", (gltf) => {\r\n+//   parachuteModel = gltf.scene;\r\n+//   parachuteModel.scale.set(0.5, 0.5, 0.5);\r\n+//   parachuteModel.visible = false;\r\n   \r\n-  scene.add(parachuteModel);\r\n-  skyDiver.setParachute(parachuteModel);\r\n-});\r\n+//   scene.add(parachuteModel);\r\n+//   skyDiver.setParachute(parachuteModel);\r\n+// });\r\n // Sizes\r\n const sizes = {\r\n   width: window.innerWidth,\r\n   height: window.innerHeight,\r\n"
                }
            ],
            "date": 1753964801196,
            "name": "Commit-0",
            "content": "import * as THREE from \"three\";\r\nimport { OrbitControls } from \"three/examples/jsm/controls/OrbitControls.js\";\r\nimport { GLTFLoader } from \"three/addons/loaders/GLTFLoader.js\";\r\nimport gsap from \"gsap\";\r\nimport GUI from \"lil-gui\";\r\nimport { SkyDiver } from \"./physics/skyDiver\";\r\nimport { Physics } from \"./physics/physics\";\r\nimport { FlyControls } from \"three/addons/controls/FlyControls.js\";\r\nimport { TrackballControls } from \"three/addons/controls/TrackballControls.js\";\r\n/** TODO:\r\n *  For \"FRONTEND\":\r\n *  1- add Models and animation\r\n *  2- add environment\r\n *  3- maybe add Lights and shadows\r\n *  For \"Backend\":\r\n *  fix rotation\r\n *  1- fix Lift power direction // above 95%\r\n *  2- test physics // above 95%\r\n *  3- maybe add Controls (rotate skydiver on wasd , openParahute on F ...)// Done\r\n *  4- make camera better\r\n */\r\n// Canvas\r\nconst canvas = document.querySelector(\".webgl\");\r\n\r\n// Scene\r\nconst scene = new THREE.Scene();\r\nconst loaderCube = new THREE.CubeTextureLoader();\r\nconst skyboxTexture = loaderCube.load([\r\n  \"./static/skybox/posx.jpg\",\r\n  \"./static/skybox/negx.jpg\",\r\n  \"./static/skybox/posy.jpg\",\r\n  \"./static/skybox/negy.jpg\",\r\n  \"./static/skybox/posz.jpg\",\r\n  \"./static/skybox/negz.jpg\",\r\n]);\r\nscene.background = skyboxTexture;\r\n \r\n// Model\r\nconst gltfLoader = new GLTFLoader();\r\nlet skydiverModel, parachuteModel;\r\n\r\ngltfLoader.load(\"./models/human.glb\", (gltf) => {\r\n  skydiverModel = gltf.scene;\r\n  skydiverModel.scale.set(1.5, 1.5, 1.5); // Adjust size\r\n  scene.add(skydiverModel);\r\n  skyDiver.setModel(skydiverModel);\r\n});\r\n\r\ngltfLoader.load(\"./models/parachute.glb\", (gltf) => {\r\n  parachuteModel = gltf.scene;\r\n  parachuteModel.scale.set(3, 3, 3);\r\n  parachuteModel.visible = false;\r\n  scene.add(parachuteModel);\r\n  skyDiver.setParachute(parachuteModel);\r\n});\r\n// Sizes\r\nconst sizes = {\r\n  width: window.innerWidth,\r\n  height: window.innerHeight,\r\n};\r\n\r\n// Camera\r\nconst camera = new THREE.PerspectiveCamera(\r\n  75,\r\n  sizes.width / sizes.height,\r\n  0.1,\r\n  10000\r\n);\r\ncamera.position.set(-0.2, 0.1, 3);\r\nscene.add(camera);\r\n\r\n// Renderer\r\nconst renderer = new THREE.WebGLRenderer({\r\n  canvas: canvas,\r\n});\r\nrenderer.setSize(sizes.width, sizes.height);\r\nrenderer.setPixelRatio(Math.min(window.devicePixelRatio, 2));\r\nrenderer.shadowMap.enabled = true;\r\nrenderer.shadowMap.type = THREE.PCFSoftShadowMap;\r\n\r\n// Controls\r\n// Maybe add orbit controls , idk\r\n// const controls = new OrbitControls(camera, canvas);\r\n// controls.enableDamping = true;\r\n\r\n// Debug\r\nconst gui = new GUI({\r\n  closeFolders: true,\r\n  title: \"Skydiving Simulation\",\r\n  width: 300,\r\n});\r\nexport const round = (num, precision = 2) => {\r\n  return num.toFixed(precision);\r\n};\r\nTHREE.Vector3.prototype.angleToFixed = function (v) {\r\n  const angle = this.angleTo(v);\r\n  return round(angle);\r\n};\r\n// Materials\r\nconst material = new THREE.MeshBasicMaterial({\r\n  color: \"white\",\r\n});\r\n\r\n// Objects\r\n\r\n// temp Skydiver\r\nconst sphereGeometry = new THREE.BoxGeometry(0.5, 0.5, 0.8);\r\nconst sphere = new THREE.Mesh(sphereGeometry, material);\r\nsphere.receiveShadow = true;\r\nsphere.position.set(-2, 0, 0);\r\nscene.add(sphere);\r\n// temp Ground\r\nconst textureLoader = new THREE.TextureLoader();\r\nconst grassTexture = textureLoader.load(\"./textures/plane.jpg\");\r\ngrassTexture.wrapS = THREE.RepeatWrapping;\r\ngrassTexture.wrapT = THREE.RepeatWrapping;\r\ngrassTexture.repeat.set(100, 100);\r\n\r\nconst groundMaterial = new THREE.MeshStandardMaterial({\r\n  map: grassTexture,\r\n});\r\n\r\nconst groundGeometry = new THREE.PlaneGeometry(30000, 30000);\r\nconst ground = new THREE.Mesh(groundGeometry, groundMaterial);\r\nground.rotation.x = -Math.PI / 2;\r\nground.receiveShadow = true;\r\nscene.add(ground);\r\n\r\n// Axis Helper\r\nconst axesHelper = new THREE.AxesHelper(500);\r\nscene.add(axesHelper);\r\n\r\n// Event Listeners\r\nconst keys = {\r\n  ArrowLeft: false,\r\n  ArrowRight: false,\r\n  ArrowUp: false,\r\n  ArrowDown: false,\r\n};\r\n\r\nwindow.addEventListener(\"keyup\", (e) => {\r\n  if (e.code in keys) keys[e.code] = false;\r\n});\r\n\r\nwindow.addEventListener(\"keydown\", (event) => {\r\n  if (event.key == \"h\") gui.show(gui._hidden);\r\n  if (event.key == \"f\") skyDiver.openParachute();\r\n  if (event.code in keys) keys[event.code] = true;\r\n});\r\n\r\nwindow.addEventListener(\"resize\", () => {\r\n  sizes.width = window.innerWidth;\r\n  sizes.height = window.innerHeight;\r\n  camera.aspect = sizes.width / sizes.height;\r\n  camera.updateProjectionMatrix();\r\n  renderer.setSize(sizes.width, sizes.height);\r\n  renderer.setPixelRatio(Math.min(window.devicePixelRatio, 2));\r\n});\r\n\r\n// Our Simulation Classes\r\nlet skyDiver = new SkyDiver();\r\nlet physics = new Physics();\r\nskyDiver.addGuiFolder(gui);\r\nphysics.addGuiFolder(gui);\r\nconst rotationSpeed = 0.1;\r\nfunction updateOrientation(deltaTime) {\r\n  let rotationSpeedDt = rotationSpeed * deltaTime;\r\n  if (skyDiver.parachuteOpend) {\r\n    if (keys[\"ArrowLeft\"]) {\r\n      skyDiver.rotateParachuteLeft(deltaTime);\r\n    }\r\n    if (keys[\"ArrowRight\"]) {\r\n      skyDiver.rotateParachuteRight(deltaTime);\r\n    }\r\n  } else {\r\n    if (keys[\"ArrowLeft\"]) {\r\n      skyDiver.rotateBody(skyDiver.bodyFront, -rotationSpeedDt);\r\n    }\r\n    if (keys[\"ArrowRight\"]) {\r\n      skyDiver.rotateBody(skyDiver.bodyFront, rotationSpeedDt);\r\n    }\r\n    if (keys[\"ArrowUp\"]) {\r\n      skyDiver.rotateBody(skyDiver.bodyRight, -rotationSpeedDt);\r\n    }\r\n    if (keys[\"ArrowDown\"]) {\r\n      skyDiver.rotateBody(skyDiver.bodyRight, rotationSpeedDt);\r\n    }\r\n  }\r\n}\r\nlet arrowHelpers = new Map();\r\nfunction drawVector(v, pos, vName, hex) {\r\n  const dir = v.clone();\r\n  dir.normalize();\r\n  const origin = pos.clone();\r\n  const length = v.length() * 2;\r\n\r\n  if (arrowHelpers.has(vName)) scene.remove(arrowHelpers.get(vName));\r\n\r\n  arrowHelpers.set(vName, new THREE.ArrowHelper(dir, origin, length, hex));\r\n  scene.add(arrowHelpers.get(vName));\r\n}\r\nconst clock = new THREE.Clock();\r\nlet lastTime = clock.getElapsedTime();\r\nlet debugVars = {\r\n  x: 0,\r\n  y: 2,\r\n  z: 1,\r\n};\r\nconst folder = gui.addFolder(\"cameraPos\");\r\nfolder.add(debugVars, \"x\");\r\nfolder.add(debugVars, \"y\");\r\nfolder.add(debugVars, \"z\");\r\nvar angle = 0,\r\n  speed = 0.03;\r\n// const loader = new GLTFLoader();\r\n// let gltfM;\r\n// loader.load(\"./models/map_pubg_erangel/scene.gltf\", (gltf) => {\r\n//   console.log(\"success\" , gltf);\r\n//   gltf.scene.scale.set(2 , 2 ,2);\r\n//   gltf.scene.position.set(0 , 1100 ,-10)\r\n//   gltfM =gltf.scene;\r\n//   scene.add(gltf.scene);\r\n// });\r\n\r\n// ðŸ’¡ Directional light (like the sun)\r\nconst sunLight = new THREE.DirectionalLight(0xffffff, 1);\r\nsunLight.position.set(100, 30000, 100);\r\nsunLight.castShadow = true;\r\nscene.add(sunLight);\r\n\r\nconst cameraTargetOffset = new THREE.Vector3(0, 3, 3); // behind & above\r\nconst smoothedCameraPos = new THREE.Vector3();\r\n\r\nconst renderLoop = () => {\r\n  const currentTime = clock.getElapsedTime();\r\n  const dt = currentTime - lastTime;\r\n  lastTime = currentTime;\r\n\r\n  // Applying Physics\r\n  updateOrientation(dt);\r\n  physics.applyForces(skyDiver);\r\n  skyDiver.update(dt);\r\n  physics.drawVectors(scene, skyDiver.position);\r\n\r\n  sphere.position.copy(skyDiver.position);\r\n  sphere.quaternion.copy(skyDiver.orientation);\r\n\r\n  drawVector(skyDiver.bodyFront, skyDiver.position, \"bodyFront\", \"red\");\r\n  drawVector(skyDiver.bodyRight, skyDiver.position, \"bodyRight\", \"green\");\r\n  drawVector(skyDiver.bodyUp, skyDiver.position, \"bodyUp\", \"blue\");\r\n  // Camera Update\r\n\r\n  let target = sphere;\r\n  const skydiverPos = target.position.clone();\r\n\r\n  // Rotate offset based on orientation\r\n  const offset = cameraTargetOffset.clone();//.applyQuaternion(target.quaternion);\r\n  const desiredCameraPos = skydiverPos.clone().add(offset);\r\n\r\n  // Smooth camera movement\r\n  smoothedCameraPos.lerp(desiredCameraPos, 0.05); // 0.05 = smooth factor\r\n  camera.position.copy(smoothedCameraPos);\r\n\r\n  // Look at the skydiver\r\n  camera.lookAt(skydiverPos);\r\n  \r\n  renderer.render(scene, camera);\r\n  window.requestAnimationFrame(renderLoop);\r\n};\r\n\r\nrenderLoop();\r\n"
        }
    ]
}